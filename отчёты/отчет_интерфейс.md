<!--metadata
updated: 2026-02-21 12:20
last_added: Добавлены страницы «Мои серверы» и «Профиль», модалка создания сервера и iframe-интеграция Planet Generator
-->

# Отчёт по интерфейсу

## Текущие элементы и их состояние

- Фон страницы: #0a001f → #1a003f (градиент)
- Сайдбар: MC/Xaero стиль, блочный фон и рамки, типографика на TipoMine
- Кнопки скрытия/показа панели: блочные, зелёный акцент
- Маскот: PNG Person (зелёная иконка), hover затемнение
- Дропдаун маскота: MC/Xaero стиль, Lucid-иконки, зелёный hover
- Иконки dev/notifications: зелёные, блочные, с контрастом на hover
- Контролы карты: кастомные zoom-кнопки справа (иконки Magnifying-Glass-Add/Reduce)
- Тулбар тестирования карты: MC/Xaero стиль (без blur, без скруглений)
- Popover тестов: MC/Xaero стиль, кнопки с зелёным hover
- Центральная область: без рамки вокруг карты (padding снят)

## Новые страницы и UI-слои (21.02.2026)

- Страница `pages/my-servers.html`:
	- заголовок + навигация
	- кнопка «Добавить сервер»
	- grid карточек серверов в стиле проводника
	- empty-state (когда серверов нет)
	- модалка «Создание сервера»
	- модалка Planet Generator (iframe на `assets/planet_web/PixelPlanets.html`)

- Страница `pages/profile.html`:
	- карточка редактирования профиля
	- статистическая карточка (серверы/планеты/анкеты/дата регистрации)

- Добавлены стили:
	- `css/servers.css`
	- `css/profile.css`

- Добавлены JS-модули:
	- `js/state.js` (хранилище)
	- `js/servers.js` (рендер серверов + создание)
	- `js/profile.js` (профиль + статистика)
	- `js/modal.js` (общая логика модалок)
	- `js/planet-generator-wrapper.js` (postMessage-интеграция генератора)

## Интеграция с картой

- Пользовательские серверы из localStorage теперь используются на `index.html` для отображения маркеров.
- При отсутствии координат серверу назначаются временные случайные координаты, чтобы он сразу попадал на карту.

## Godot Web: статус и ограничения

- Ошибка `Cross Origin Isolation / SharedArrayBuffer` воспроизводится при запуске без правильных HTTP-заголовков.
- Проверка: при запуске через локальный COI-сервер заголовки присутствуют и Planet Generator открывается корректно.

## Использованные цвета (палитра)
- Основной фон: #0a001f (очень тёмный синий-фиолетовый)
- Градиент карты: #0a001f → #1a003f
- MC-палитра: #3f3f3f / #2b2b2b / #000000
- Акцент: #55ff55 (зелёный)
- Текст: #ffffff / #aaaaaa

## Изображения / заглушки (текущие и планируемые)
- Маскот: Person.png (Lucid Icons, 160px) — зелёный, 64×64 контейнер
- Фон карты: градиент (в планах — космический фон)
- Иконки dev/notifications: Lucid Icons (Gear, Message-Three-Dots/Exclamation)
- Zoom-контролы: Lucid Icons (Magnifying-Glass-Add/Reduce)

## Проблемы интерфейса
- Критичных проблем не зафиксировано
- Потенциальное улучшение: заменить emoji в map-tools на Lucid-иконки

## Гарантии движения и анимаций (актуально)

- Переключение сайдбара больше не вызывает сброс анимации космической сцены.
- Карта и canvas не переинициализируются от интерфейсных переходов; состояние движения сохраняется.
- Орбиты и мерцание телесных объектов считаются от синхронизированного времени (серверный `Date` + offset), а не от локального FPS.
- Выполняется фоновый ресинк часов (по возвращению во вкладку и периодически), чтобы уменьшать накопленный дрейф.
- Контролы zoom/center зафиксированы к краю viewport и не зависят от transform карты/сайдбара.
- На resize выполняется адаптация размеров без «обнуления» движения.
- Центрирование камеры выполняется плавно (через интерполяцию), без резкого прыжка сцены.
- При открытии/закрытии сайдбара центр мира сохраняется относительно видимого окна карты.
- Компенсация центра синхронизирована с фактическим `transform` сайдбара, поэтому переход выглядит ровно.
- При закрытом сайдбаре карта полностью покрывает экран (без пустого зазора слева).

## Следующие визуальные задачи
- Добавить космический фон карты (изображение)
- Заменить emoji в map-tools на Lucid-иконки
- Начать media queries для мобильных (sidebar на весь экран, маскот меньше и т.д.)